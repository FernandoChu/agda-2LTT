# Permutations

```agda
{-# OPTIONS·µâ --lossy-unification·µâ #-}

module finite-group-theory.permutations·µâ where
```

<details><summary>Imports</summary>

```agda
open import elementary-number-theory.modular-arithmetic-standard-finite-types·µâ
open import elementary-number-theory.natural-numbers·µâ

open import finite-group-theory.orbits-permutations·µâ
open import finite-group-theory.permutations-standard-finite-types·µâ
open import finite-group-theory.transpositions·µâ

open import foundation.action-on-identifications-functions·µâ
open import foundation.cartesian-product-types·µâ
open import foundation.contractible-types·µâ
open import foundation.coproduct-types·µâ
open import foundation.decidable-propositions·µâ
open import foundation.dependent-pair-types·µâ
open import foundation.empty-types·µâ
open import foundation.equality-dependent-pair-types·µâ
open import foundation.equivalence-extensionality·µâ
open import foundation.equivalences·µâ
open import foundation.function-types·µâ
open import foundation.identity-types·µâ
open import foundation.iterating-functions·µâ
open import foundation.iterating-involutions·µâ
open import foundation.propositional-truncations·µâ
open import foundation.propositions·µâ
open import foundation.sets·µâ
open import foundation.truncated-types·µâ
open import foundation.truncation-levels·µâ
open import foundation.unit-type·µâ
open import foundation.universe-levels·µâ

open import group-theory.generating-sets-groups·µâ
open import group-theory.subgroups-generated-by-subsets-groups·µâ
open import group-theory.symmetric-groups·µâ

open import lists.functoriality-lists·µâ
open import lists.lists·µâ

open import univalent-combinatorics.2-element-decidable-subtypes·µâ
open import univalent-combinatorics.2-element-types·µâ
open import univalent-combinatorics.counting·µâ
open import univalent-combinatorics.finite-types·µâ
open import univalent-combinatorics.standard-finite-types·µâ
```

</details>

## Idea

A·µâ permutation·µâ of·µâ X·µâ is·µâ an·µâ automorphism·µâ of·µâ X.·µâ

## Properties

```agda
module _
  {l1·µâ l2·µâ : Level} (X·µâ : UU·µâ l1·µâ) (eX·µâ : count·µâ X·µâ) (f·µâ : X·µâ ‚âÉ·µâ X·µâ)
  where

  list-transpositions-permutation-count·µâ :
    list·µâ
      ( Œ£·µâ
        ( X·µâ ‚Üí Decidable-Prop·µâ l2·µâ)
        ( Œª P·µâ ‚Üí
          has-cardinality·µâ 2 (Œ£·µâ X·µâ (type-Decidable-Prop·µâ ‚àò·µâ P·µâ))))
  list-transpositions-permutation-count·µâ =
    map-list·µâ
      ( transposition-conjugation-equiv·µâ
        ( Fin·µâ (number-of-elements-count·µâ eX·µâ))
        ( X·µâ)
        ( equiv-count·µâ eX·µâ))
      ( list-transpositions-permutation-Fin·µâ
        ( number-of-elements-count·µâ eX·µâ)
        ( (inv-equiv-count·µâ eX·µâ ‚àòe·µâ f·µâ) ‚àòe·µâ equiv-count·µâ eX·µâ))

  abstract
    retraction-permutation-list-transpositions-count·µâ :
      htpy-equiv·µâ
        ( permutation-list-transpositions·µâ list-transpositions-permutation-count·µâ)
        ( f·µâ)
    retraction-permutation-list-transpositions-count·µâ x·µâ =
      ( correct-transposition-conjugation-equiv-list·µâ
        ( Fin·µâ (number-of-elements-count·µâ eX·µâ))
        ( X·µâ)
        ( equiv-count·µâ eX·µâ)
        ( list-transpositions-permutation-Fin·µâ
          ( number-of-elements-count·µâ eX·µâ)
          ( (inv-equiv-count·µâ eX·µâ ‚àòe·µâ f·µâ) ‚àòe·µâ equiv-count·µâ eX·µâ))
        ( x·µâ)) ‚àô·µâ
        ( ( ap·µâ
            ( map-equiv-count·µâ eX·µâ)
            ( retraction-permutation-list-transpositions-Fin·µâ
              ( number-of-elements-count·µâ eX·µâ)
              ( (inv-equiv-count·µâ eX·µâ ‚àòe·µâ f·µâ) ‚àòe·µâ equiv-count·µâ eX·µâ)
              ( map-inv-equiv-count·µâ eX·µâ x·µâ))) ‚àô·µâ
          ( ( htpy-eq-equiv·µâ
              ( right-inverse-law-equiv·µâ (equiv-count·µâ eX·µâ))
              ( map-equiv·µâ ((f·µâ ‚àòe·µâ (equiv-count·µâ eX·µâ)) ‚àòe·µâ inv-equiv-count·µâ eX·µâ) x·µâ)) ‚àô·µâ
            ( ap·µâ
              ( Œª g·µâ ‚Üí map-equiv·µâ (f·µâ ‚àòe·µâ g·µâ) x·µâ)
              ( right-inverse-law-equiv·µâ (equiv-count·µâ eX·µâ)))))
```

### For `X` finite, the symmetric group of `X` is generated by transpositions

```agda
module _
  {l1·µâ l2·µâ : Level} (n·µâ : ‚Ñï·µâ) (X·µâ : UU-Fin·µâ l1·µâ n·µâ)
  where

  is-generated-transposition-symmetric-Fin-Level·µâ :
    is-generating-set-Group·µâ
      ( symmetric-Group·µâ (set-UU-Fin·µâ n·µâ X·µâ))
      ( is-transposition-permutation-Prop·µâ)
  is-generated-transposition-symmetric-Fin-Level·µâ f·µâ =
    apply-universal-property-trunc-Prop·µâ
      ( has-cardinality-type-UU-Fin·µâ n·µâ X·µâ)
      ( subset-subgroup-subset-Group·µâ
        ( symmetric-Group·µâ (set-UU-Fin·µâ n·µâ X·µâ))
        ( is-transposition-permutation-Prop·µâ)
        ( f·µâ))
      ( Œª h·µâ ‚Üí
        unit-trunc-Prop·µâ
          ( pair·µâ
            ( map-list·µâ
              ( Œª x·µâ ‚Üí
                pair·µâ
                  ( inr·µâ star·µâ)
                  ( pair·µâ
                    ( transposition·µâ x·µâ)
                    ( unit-trunc-Prop·µâ (pair·µâ x·µâ refl·µâ))))
              ( list-transpositions-permutation-count·µâ
                ( type-UU-Fin·µâ n·µâ X·µâ)
                ( pair·µâ n·µâ h·µâ)
                ( f·µâ)))
            ( ( lemma·µâ
                ( list-transpositions-permutation-count·µâ
                  ( type-UU-Fin·µâ n·µâ X·µâ)
                  ( pair·µâ n·µâ h·µâ)
                  ( f·µâ))) ‚àô·µâ
              ( eq-htpy-equiv·µâ
                ( retraction-permutation-list-transpositions-count·µâ
                  ( type-UU-Fin·µâ n·µâ X·µâ)
                  ( pair·µâ n·µâ h·µâ)
                  ( f·µâ))))))
    where
    lemma·µâ :
      (l·µâ : list·µâ (2-Element-Decidable-Subtype·µâ l2·µâ (type-UU-Fin·µâ n·µâ X·µâ))) ‚Üí
      Id·µâ
        ( ev-formal-combination-subset-Group·µâ
          ( symmetric-Group·µâ (set-UU-Fin·µâ n·µâ X·µâ))
          ( is-transposition-permutation-Prop·µâ)
          ( map-list·µâ
            ( Œª x·µâ ‚Üí
              pair·µâ
                ( inr·µâ star·µâ)
                ( pair·µâ (transposition·µâ x·µâ) (unit-trunc-Prop·µâ (pair·µâ x·µâ refl·µâ))))
            ( l·µâ)))
        ( permutation-list-transpositions·µâ l·µâ)
    lemma·µâ nil·µâ = refl·µâ
    lemma·µâ (cons·µâ x·µâ l·µâ) = ap·µâ ((transposition·µâ x·µâ) ‚àòe·µâ_) (lemma·µâ l·µâ)
```

```agda
module _
  {l·µâ : Level} (n·µâ : ‚Ñï·µâ) (X·µâ : UU-Fin·µâ l·µâ n·µâ)
  where

  module _
    (f·µâ : (type-UU-Fin·µâ n·µâ X·µâ) ‚âÉ·µâ (type-UU-Fin·µâ n·µâ X·µâ))
    where

    parity-transposition-permutation·µâ : UU·µâ (lsuc l·µâ)
    parity-transposition-permutation·µâ =
      Œ£·µâ ( Fin·µâ 2·µâ)
        ( Œª k·µâ ‚Üí
          type-trunc-Prop·µâ
            ( Œ£·µâ
              ( list·µâ
                ( Œ£·µâ
                  ( type-UU-Fin·µâ n·µâ X·µâ ‚Üí Decidable-Prop·µâ l·µâ)
                  ( Œª P·µâ ‚Üí
                    has-cardinality·µâ 2
                      ( Œ£·µâ (type-UU-Fin·µâ n·µâ X·µâ) (type-Decidable-Prop·µâ ‚àò·µâ P·µâ)))))
              ( Œª li·µâ ‚Üí
                Id·µâ k·µâ (mod-two-‚Ñï·µâ (length-list·µâ li·µâ)) √ó·µâ
                Id·µâ f·µâ (permutation-list-transpositions·µâ li·µâ))))

    abstract
      is-contr-parity-transposition-permutation·µâ :
        is-contr·µâ parity-transposition-permutation·µâ
      is-contr-parity-transposition-permutation·µâ =
        apply-universal-property-trunc-Prop·µâ
          ( has-cardinality-type-UU-Fin·µâ n·µâ X·µâ)
          ( is-trunc-Prop·µâ neg-two-ùïã·µâ parity-transposition-permutation·µâ)
          ( Œª h·µâ ‚Üí
            pair·µâ
              ( pair·µâ
                ( mod-two-‚Ñï·µâ (length-list·µâ (list-transposition-f·µâ h·µâ)))
                ( unit-trunc-Prop·µâ
                  ( pair·µâ (list-transposition-f·µâ h·µâ)
                    ( pair·µâ refl·µâ
                      ( inv·µâ
                        ( eq-htpy-equiv·µâ
                          ( retraction-permutation-list-transpositions-count·µâ
                            ( type-UU-Fin·µâ n·µâ X·µâ)
                            ( pair·µâ n·µâ h·µâ)
                            ( f·µâ))))))))
              ( Œª (pair·µâ k·µâ u·µâ) ‚Üí
                eq-pair-Œ£·µâ
                  ( apply-universal-property-trunc-Prop·µâ u·µâ
                    ( Id-Prop·µâ
                      ( Fin-Set·µâ 2·µâ)
                      ( mod-two-‚Ñï·µâ (length-list·µâ (list-transposition-f·µâ h·µâ)))
                      ( k·µâ))
                    ( Œª (pair·µâ li·µâ (pair·µâ q·µâ r·µâ)) ‚Üí
                      is-injective-iterate-involution·µâ
                        ( mod-two-‚Ñï·µâ (length-list·µâ (list-transposition-f·µâ h·µâ)))
                        ( k·µâ)
                        ( sign-permutation-orbit·µâ
                          ( n·µâ)
                          ( pair·µâ (type-UU-Fin·µâ n·µâ X·µâ) (unit-trunc-Prop·µâ h·µâ))
                          ( id-equiv·µâ))
                        ( inv·µâ
                          ( iterate-involution·µâ
                            ( succ-Fin·µâ 2·µâ)
                            ( is-involution-aut-Fin-two-‚Ñï·µâ (equiv-succ-Fin·µâ 2·µâ))
                            ( length-list·µâ (list-transposition-f·µâ h·µâ))
                            ( sign-permutation-orbit·µâ
                              ( n·µâ)
                              ( pair·µâ (type-UU-Fin·µâ n·µâ X·µâ) (unit-trunc-Prop·µâ h·µâ))
                              ( id-equiv·µâ))) ‚àô·µâ
                          ( ( sign-list-transpositions-count·µâ
                              ( type-UU-Fin·µâ n·µâ X·µâ)
                              ( pair·µâ n·µâ h·µâ)
                              ( list-transposition-f·µâ h·µâ)) ‚àô·µâ
                            ( ap·µâ
                              ( sign-permutation-orbit·µâ
                                ( n·µâ)
                                ( pair·µâ (type-UU-Fin·µâ n·µâ X·µâ) (unit-trunc-Prop·µâ h·µâ)))
                              { x·µâ =
                                permutation-list-transpositions·µâ
                                  ( list-transposition-f·µâ h·µâ)}
                              { y·µâ = permutation-list-transpositions·µâ li·µâ}
                              ( ( eq-htpy-equiv·µâ
                                  ( retraction-permutation-list-transpositions-count·µâ
                                    ( type-UU-Fin·µâ n·µâ X·µâ)
                                    ( pair·µâ n·µâ h·µâ)
                                    ( f·µâ))) ‚àô·µâ
                                ( r·µâ)) ‚àô·µâ
                              ( inv·µâ
                                ( sign-list-transpositions-count·µâ
                                  ( type-UU-Fin·µâ n·µâ X·µâ)
                                  ( pair·µâ n·µâ h·µâ)
                                  ( li·µâ)) ‚àô·µâ
                                ( ( iterate-involution·µâ
                                    ( succ-Fin·µâ 2·µâ)
                                    ( is-involution-aut-Fin-two-‚Ñï·µâ
                                      ( equiv-succ-Fin·µâ 2·µâ))
                                    ( length-list·µâ li·µâ)
                                  ( sign-permutation-orbit·µâ
                                    ( n·µâ)
                                    ( pair·µâ
                                      ( type-UU-Fin·µâ n·µâ X·µâ)
                                      ( unit-trunc-Prop·µâ h·µâ))
                                    ( id-equiv·µâ))) ‚àô·µâ
                                  ( ap·µâ
                                    ( Œª k·µâ ‚Üí
                                      iterate·µâ
                                        ( nat-Fin·µâ 2 k·µâ)
                                        (succ-Fin·µâ 2·µâ)
                                        ( sign-permutation-orbit·µâ
                                          ( n·µâ)
                                          ( pair·µâ
                                            ( type-UU-Fin·µâ n·µâ X·µâ)
                                            ( unit-trunc-Prop·µâ h·µâ))
                                          ( id-equiv·µâ)))
                                    ( inv·µâ q·µâ)))))))))
                  ( eq-is-prop·µâ is-prop-type-trunc-Prop·µâ)))
        where
        list-transposition-f·µâ :
          (h·µâ : Fin·µâ n·µâ ‚âÉ·µâ (type-UU-Fin·µâ n·µâ X·µâ)) ‚Üí
          list·µâ
            ( Œ£·µâ
              ( type-UU-Fin·µâ n·µâ X·µâ ‚Üí Decidable-Prop·µâ l·µâ)
              ( Œª P·µâ ‚Üí
                has-cardinality·µâ 2
                  ( Œ£·µâ (type-UU-Fin·µâ n·µâ X·µâ) (type-Decidable-Prop·µâ ‚àò·µâ P·µâ))))
        list-transposition-f·µâ h·µâ =
          list-transpositions-permutation-count·µâ (type-UU-Fin·µâ n·µâ X·µâ) (pair·µâ n·µâ h·µâ) f·µâ
        is-injective-iterate-involution·µâ :
          (k·µâ k'·µâ x·µâ : Fin·µâ 2·µâ) ‚Üí
          Id·µâ
            ( iterate·µâ (nat-Fin·µâ 2 k·µâ) (succ-Fin·µâ 2·µâ) x·µâ)
            ( iterate·µâ (nat-Fin·µâ 2 k'·µâ) (succ-Fin·µâ 2·µâ) x·µâ) ‚Üí
          Id·µâ k·µâ k'·µâ
        is-injective-iterate-involution·µâ
          (inl·µâ (inr·µâ star·µâ)) (inl·µâ (inr·µâ star·µâ)) x·µâ p·µâ =
          refl·µâ
        is-injective-iterate-involution·µâ
          (inl·µâ (inr·µâ star·µâ)) (inr·µâ star·µâ) (inl·µâ (inr·µâ star·µâ)) p·µâ =
          ex-falso·µâ (neq-inl-inr·µâ p·µâ)
        is-injective-iterate-involution·µâ
          (inl·µâ (inr·µâ star·µâ)) (inr·µâ star·µâ) (inr·µâ star·µâ) p·µâ =
          ex-falso·µâ (neq-inr-inl·µâ p·µâ)
        is-injective-iterate-involution·µâ
          (inr·µâ star·µâ) (inl·µâ (inr·µâ star·µâ)) (inl·µâ (inr·µâ star·µâ)) p·µâ =
          ex-falso·µâ (neq-inr-inl·µâ p·µâ)
        is-injective-iterate-involution·µâ
          (inr·µâ star·µâ) (inl·µâ (inr·µâ star·µâ)) (inr·µâ star·µâ) p·µâ =
          ex-falso·µâ (neq-inl-inr·µâ p·µâ)
        is-injective-iterate-involution·µâ
          (inr·µâ star·µâ) (inr·µâ star·µâ) x·µâ p·µâ = refl·µâ
```